# Покращення класифікації емоцій в українських текстах  
**Enhancing Emotion Classification in Ukrainian Texts via Reconstruction Error Features from a Generating Element Space**

---

## Огляд проєкту  
Цей проєкт демонструє гібридний підхід до класифікації емоцій в українських текстах. Ми доповнюємо результати state-of-the-art трансформерних моделей новими ознаками, згенерованими на основі похибки реконструкції в просторі з порідним елементом (просторі Кунченка). Експерименти на датасеті EMOBENCH-UA показують підвищення макро F1-score із 0.6031 до 0.6302.

---


## Назва та альтернативна англійська назва  
- **Українською:** Покращення класифікації емоцій в українських текстах за допомогою ознак, згенерованих методом реконструкції в просторі з порідним елементом  
- **English (alternative):** Enhancing Emotion Classification in Ukrainian Texts via Reconstruction Error Features from a Generating Element Space  

---

## Анотація  
Розпізнавання емоцій у текстах є важливою задачею обробки природної мови, особливо для мов з обмеженими ресурсами, таких як українська. Існуючі підходи, засновані на трансформерних архітектурах, досягають високої точності, але можуть не вловлювати всі нюанси семантичного простору. У цій роботі ми пропонуємо новий гібридний метод, який доповнює вихідні дані state-of-the-art класифікатора емоцій новими ознаками, згенерованими на основі апарату розкладу в просторі з порідним елементом (просторі Кунченка). Ми застосовуємо цей метод до векторних представлень текстів (ембедингів), навчаючи класо-специфічні моделі реконструкції для кожної емоції з використанням оптимально підібраного дробно-степеневого базису. Похибка реконструкції цими моделями слугує новим набором ознак. Експерименти на публічному датасеті EMOBENCH-UA показали, що додавання 7 згенерованих ознак до вихідних ймовірностей трансформерної моделі підвищує усереднений F1-score з 0.6031 до 0.6302, що демонструє додаткову інформаційну цінність запропонованого підходу. Метод є універсальним і може бути застосований для покращення якості класифікації в різних задачах аналізу текстів.

---

## Ключові слова  
- розпізнавання емоцій  
- обробка природної мови  
- українська мова  
- простір Кунченка  
- генерація ознак  
- гібридна модель  
- метод опорних векторів (як фінальний класифікатор)  
- ембединги  

---

## Вступ  
1. **Актуальність**  
   - Класифікація емоцій у текстах потрібна для багатьох застосувань: соціальні мережі, служби підтримки, аналіз зворотного зв’язку.  
   - Для української мови ресурси обмежені, тому важливо шукати методи, які підвищують якість класифікації.  
2. **Огляд існуючих підходів**  
   - Лінгвістичні методи: правила та словники, що дають базове рішення, але важко масштабуються.  
   - Моделі на основі трансформерів (наприклад, XLM-RoBERTa, ukr-emotions-classifier): демонструють високі показники, але іноді пропускають тонкі семантичні відмінності.  
   - LLM-підходи: можуть давати контекстуальні оцінки, але потребують багато ресурсів для inference.  
   - Використання зовнішніх ознак: додавання статистичних чи інжене-орієнтованих характеристик може доповнити трансформерні фічі.  
3. **Проблема**  
   - Трансформерні ембединг-вектори містять багатий семантичний контекст, але класичні класифікатори можуть не використати всю внутрішню структуру простору ембедингів.  
4. **Внесок роботи**  
   - Запропоновано метод генерації нових ознак на основі похибки реконструкції ембедингів у просторі з порідним елементом (Кунченка) для кожного класу емоцій.  
   - Показано, що ці ознаки несуть унікальну інформацію, доповнюючи вихідні ймовірності трансформерної моделі.  
   - Демонстрація підвищення F1-score на EMOBENCH-UA.  

---

## Опис методу

### Представлення тексту у векторному просторі  
- Кожен текст `T` перетворюється на ембединг `X ∈ ℝ^D` за допомогою попередньо навченої моделі-енкодера (наприклад, використовуючи `AutoModel` від `ukr-detect/ukr-emotions-classifier`).  
- Використовуємо виходи останнього прихованого шару CLS-токена; звичайно `D=1024`.

### Концепція простору з порідним елементом (Кунченка)  
- Ідея: апроксимувати випадковий вектор `X` стохастичним поліномом у вигляді:  
  > `Y = k₀ + Kᵀ Φ(X)`  
  де `Φ(X)` — вектор нелінійних базисних функцій від компонент ембединга.  
- Коефіцієнти знаходяться з умови мінімізації середньоквадратичної похибки `E[||X - Y||²]`.  
- Розглядаємо дробно-степеневий базис (наприклад, степені 1/2 і 1/3 з регуляризацією), що дає змогу вловлювати «геометричні» властивості простору ембедингів.

### Генерація ознак на основі похибки реконструкції  
1. **Навчання класо-специфічних моделей реконструкції**  
   - Для кожного класу емоцій `c ∈ {1..M}` (у проєкті M=7, включно з None) вибираємо зразки лише цього класу.  
   - Для кожної компоненти ембединга `d = 1..D`:  
     - Обчислюємо статистики: середнє `E[x_d]`, середні значення базисних функцій `E[φ_j(x_d)]`.  
     - Формуємо матрицю коваріації базисних функцій `F_d` та вектор `b_d` для нормальних рівнянь із L2-регуляризацією.  
     - Розв’язуємо систему для знаходження коефіцієнтів `K_d` і зсуву `k₀_d`.  
   - Результатом є набір параметрів `{(K_d^(c), k₀_d^(c)) | d=1..D}` для кожного класу.  
2. **Формування ознак для нового тексту**  
   - Для нового ембединга `X_new`:  
     - Для кожної компоненти `x_new,d` обчислюємо базисні функції `Φ(x_new,d)`.  
     - Виконуємо реконструкцію `y_new,d^(c) = k₀_d^(c) + (K_d^(c))ᵀ (Φ(x_new,d) - E[Φ_d^(c)])`.  
     - Обчислюємо помилку `err_d^(c) = (x_new,d - y_new,d^(c))²`.  
   - Сумарна MSE для класу `c`:  
     > `MSE_c = (1/D) * Σ_d err_d^(c)`  
   - Фінальна ознака:  
     > `f_c = log(MSE_c + ε_log)`  
   - Отримуємо вектор ознак Кунченка `F_K(X_new) = [f₁, f₂, ..., f_M]`.

---

## Експериментальне дослідження

### Датасет  
- Використовується публічний датасет EMOBENCH-UA для розпізнавання емоцій в українських текстах.  
- Інформація про розподіл класів, розмір наборів тренування/тестування, попередня обробка текстів (токенізація, очищення за необхідності).  
- Можлива генерація "None" як окремого класу, якщо текст не містить чітких емоційних маркерів.

### Базова модель (бенчмарк)  
- Використовуємо попередньо натреновану модель `ukr-detect/ukr-emotions-classifier` (XLM-RoBERTa-large або подібну) для отримання ймовірностей належності до кожного з 7 класів.  
- Зберігаємо вихідний вектор ймовірностей `P = [p₁, ..., p_M]` для кожного тексту.

### Гібридна модель  
1. **Отримання ембедингів:**  
   - Для кожного тексту отримуємо CLS-ембединг розмірності D (наприклад, 1024).  
2. **Генерація ознак Кунченка:**  
   - Застосовуємо описаний вище метод до CLS-ембедингів, одержуючи вектор з M=7 ознак реконструкційних помилок.  
3. **Формування гібридного вектору:**  
   - Конкатенуємо `[p₁, ..., p_M]` та `[f₁, ..., f_M]` → отримуємо вектор розмірності 2M (14).  
4. **Фінальний класифікатор:**  
   - Використовуємо OneVsRestClassifier з базовим оцінювачем LogisticRegression (параметри: C=1.0, solver='liblinear' або інші оптимальні налаштування).  
   - Навчаємо модель на гібридних ознаках.  
5. **Валідація та тюнінг:**  
   - Можна використовувати крос-валідацію або окрему валідаційну вибірку для підбору гіперпараметрів (регуляризація, обробка imbalance класів).  

### Метрики оцінки  
- **Macro F1-score** як основна метрика.  
- Детальний `classification_report` (precision, recall, F1 для кожного класу).  
- Додатково: Confusion matrix, ROC-AUC (за наявності двокласових оцінок для кожної емоції), статистичні тести для оцінки значущості приросту.

---

## Результати та обговорення  
- **Порівняння F1-macro:**  
  - **Бенчмарк (лише трансформер):** F1 = 0.6031  
  - **Гібридна модель:** F1 = 0.6302  
  - Приріст: +0.0271 (приблизно +4.5%).  
- **Статистична значущість:**  
  - За можливості провести бутстреп або інший тест, щоб перевірити, чи значущий цей приріст.  
- **Аналіз покращення по класах:**  
  - Наприклад, найбільший приріст для певних емоцій (Anger, Disgust тощо).  
  - Можливе відображення результатів у таблиці або графіку (bar chart для F1 кожного класу до/після).  
- **Інтерпретація:**  
  - Ознаки Кунченка вловлюють внутрішню «геометрію» простору ембедингів, яка не завжди враховується чисто ймовірнісним виходом трансформера.  
  - Додаючи помилку реконструкції як ознаку, ми дозволяємо фінальному класифікатору скористатися цими додатковими характеристиками для кращого розділення класів.  
- **Обговорення обмежень:**  
  - Обчислювальна складність: навчання моделей реконструкції для кожної компоненти ембедингів і кожного класу може бути ресурсоємним при великій розмірності D.  
  - Регуляризація: потребує налаштування λ_reg для уникнення overfitting моделей реконструкції.  
  - Узагальнюваність: перевірити на інших датасетах і мовах.  

---

## Висновки  
- Запропоновано гібридний метод генерації ознак на основі похибки реконструкції у просторі Кунченка для класифікації емоцій у текстах.  
- Доведено, що додаткові ознаки підвищують макро F1-score на EMOBENCH-UA з 0.6031 до 0.6302.  
- Підкреслено універсальність підходу: метод може бути застосований до інших NLP-задач (аналіз тональності, токсичність) та до інших типів ембедингів.  
- Метод поєднує статистичний «геометричний» аналіз простору ембедингів із можливостями сучасних трансформерних моделей.

---

## Подальші напрямки досліджень  
- **Інші NLP-задачі:** тональність, виявлення токсичності, класифікація намірів тощо.  
- **Альтернативні ембединг-моделі:** порівняння з іншими архітектурами (BERT-модифікації, мультимодальні ембединг-моделі).  
- **Оптимізація обчислень:** зменшення розмірності або використання стохастичних підходів для швидшої оцінки похибки реконструкції.  
- **Інтеграція в архітектуру:** вбудовування ознак реконструкції безпосередньо у тренування нейромережевих моделей (наприклад, додаткові шари або регуляризація).  
- **Розширена регуляризація:** вивчення впливу різних видів регуляризації на якість моделей реконструкції.  
- **Оцінка на різних мовах:** адаптація до мов з обмеженими ресурсами та багатомовні моделі.  
- **Статистична перевірка:** детальніше дослідження значущості покращень через різні тестування (bootstrapping, перекладні вибірки).  

---

## Подяки  
- Авторам датасету EMOBENCH-UA.  

---

## Список літератури  
1. Dementieva, D., Babakov, N., & Fraser, A. (2025). EmoBench-UA: A Benchmark Dataset for Emotion Detection in Ukrainian [Preprint]. arXiv. https://doi.org/10.48550/arXiv.2505.23297  
2. Заболотній, С. (2009). Статистичне розпізнавання образів на основі розкладу в просторі з порідним елементом. Вісник Національного університету “Львівська політехніка”, № 638: Комп'ютерні науки та інформаційні технології, 118–123. Отримано з https://ena.lpnu.ua/bitstreams/78d4f128-149a-4833-acf5-49506903471e/download  

